language: node_js
node_js:
  - "6"

before_install:
  - npm install -g gulp
  - gulp -v
  - wget https://releases.hashicorp.com/terraform/0.9.0/terraform_0.9.0_linux_amd64.zip -O /tmp/terraform.zip
  - sudo unzip -d /usr/local/bin/ /tmp/terraform.zip

install:
  - npm install

script:
  - gulp build
  - terraform init infra
  - terraform apply -var 'lambda_zip=dist/lambda.zip' infra > /dev/null

env:
  global:
    - TF_LOG=ERROR
    # AWS credentials
    - secure: U+PDZEiYCAS6U1vFtbdB9XtgNjwYrUue14QWd5FTu5KznemGNH9XyZy6J/eR3YzZKyPP7x3NtLXa85d9gOZ7eWo+qx8a6IjmZjKPaAEiQ78dSipEv+mFFMvBI3ZjZ8pdTqzYDkvCViXr+89KffqfFS43vPgVYDxFfzwat9fUMvnb08FPiHfaIlkPmmiuXaW2rwQrVYHy0w/vba3OJlNCJIjfxdwg7BH5bNNKDSupmnRq1SomROOhBVIh110YgYxGrkkPemjyK6fEhvHreOWiWvd0IZmUlwqMu8P6QrgJuxlY/2sdozTdkw/zXKHRU1aeZ3A0IOzodmDS4Uc157eLZXAwL4bMwk0TJ4PGNx/KjLbPwC/ujOpNU7POAv+72zoeiJy5wI1OA59yYvw5BaB982/NeMz2xOdxODKAc6K+Kp08vIx12NLjpSwLi8NyuLI/NkaAGHmPPRm64Ea7qRMvO3xULxBtVU6iJeWsb1n802iF2T7EnT3s0s51WL/nXXqZRqvqGLbFWz27PLE6naRhbAMrLlYXNU274gNhgMiNCqm4e8DJAQiMewHm1d4bCVrjtPXI3wh5Vb0u9XZa29DMqgiXQxl4qqRqlgYKpN5jYDEOqQ2qXomG06jgaTqBO2vZ5Y0I6jVkKjRNGSdKyEcMawtyD3LWRVar2Jxyk7ebOaI=
    - secure: ieyXK5UW+hOEvZM4j/tVQcpi4ija/opXa+1HoIpwhrwLy77UvIiEXmFnT2zEFBex5a1RsZCvD4pL0LNSyphsTeAgNnYaj327xGAPhmv+ybVubg05D8LsZS2+fNuYlq2i8ce/QGWdN5surIY0neka4ydI6nPqqHAn5Yacx2mDxHYhAV9YHzdzvp2HqtRiE8MC7oRIpOAmrxSN79XSKObZbBP69B1lCKmZM4Hep6Lb4+rfx9r39xIFkEj2JvQGPe4wvseeXFolNXiB6xa0jeWQwVti6rNeUEVOlsVMdEdMOBUcjlpIdGpn2ZfDKdpPH5/3tu8MxJ+sozBw4Wh7CK7JiYJSOA/wzXSRT+QI9DtEFthxKZhej2kyjyHVrZod+Lzk7mI12FuGQIHGAbJpRGyOeRYt5S8IEEVbecP2efU51en4mzyX5soTjkLh0cx7ja8toiMMsDrfiFKYh0s4m/QN6jKrsZuFQctOvS6e7wj4dxi4xNiNuaKLfqlWd1LVc1S9Xfm7LpPUNleunzQfUkyJ6K1mxHWMl/PUJ5krSW3W+R6cs5qo8dSCZUVKPHHTPO+RtNrERlsHaHXCsFe8XhVWGxfsZWVJwvPDseXahFjIUXiEktFuXeSrbcg92PSmIWjlC94zsIMstDd3KG1XUFy56+U+x15lsmtG3J6zf0pweT4=
    # TF_VAR_wallet_pw
    - secure: kHqvartAeFK9KqjFFm79j1uh9zwv+A1i1iZykuZ7O77yqPTt74Wonu6xerEqHCsP+WNzck5MvUdklG9+3BNHFHROhNRewO+v8bguWNC/0z0DdscR/dv7n3WGhtM9sAdy1EBOmxfieOONgdz22yNfzP7wDPj8k9crR5tHUubZVFRT8ab5BaB8IxjB0s5nYm69mGXUK5bAd+NB8ph4J8UUhZuaoZWjSGBy6Q8zSGM9DfV7dGRo77lQIzSuTHLwWd7TKIyzLbHAlvPLrXjjRXW4ONoUPTvGfmR6jtdE3IVoH71Tt/FGuyx8XaP3BVP42nSs6eHCH3QvYsp24JphsX1JsMwoj2hDhw53hUs9FkbNZpfo7ihp3if4JwcaW93nvrSqaWbukaZc1NYAqleoMRtrDDVCJKSdtY5i3IOzL62B6UZUEOSZn4mpj5UvBqyDnI0D+wiMfKgnzoW5AjKTzIiXWuybs1ei3S0+75u/nycXmhmlYYd8tlI2sfKuww4aBxxMbAp1TCPv6yLQ5MebJLZ6YHdsrffp5xXPoeskwkOTAFwHrmLHHG8+a1syXq0BXE1QuPpmwJBCJLiRWYVkC/gyEFO0lP8Vlnc68ho+ITM2zGRaRzWSU5xgGAefngHxPaidHQtbrxzUSWNMEgOnvd8r7ZB3MpSyMiM/u4RzWqFQsPM=
    # TF_VAR_wallet_merchant
    - secure: l4XKhXMTjgdzLlGgSuzfVAIoKDyfo6h7KUv67YFL3GNZyalDzeDzGrv8wNvFEzf/SBcvA372EKNsV2yWP6K7vp2TNcw48IYQjXAkRHfvv25xGl1S69y4b6eElmgip5wuGEg5/YV3H51+C0bi5TbSPBkwWKiOdCDg+LgKphcqUnHIP9GJBRwMgqTaYQ76OdYn7YCD5YdNnwPK8mhhKUkL/HExwygwHHGgHiUlUUuAKOyFN8N7HQwCSjexP/asqPgdy2BWx9nvLsx3IhbkXv2hU2spZSoHWydxUEiSF1dP0yoxkdJzp9sY6pWpb/56Ac6Ydkzh5J8XO1vk9PEHPz60aGFmn4pc7vZZpdR06gzoqIS8c/xN5kTNHVDlvZgIBMYbF5AYxJSjWHaDBSCYTHfDgWM2jw2j/6wB8DfbnAXP9WJc6LdVvMmjxDAAb7gRQxxPFOJ8Ut6Bie60XeHgcr3eDrZIjtP9d7rSlfgb7T/EmiRzscVo92uPYZRLvUfuCNDcbTs5ZGkvKjrIsU70MLs9ZwzsRC09wXEEhZUptQx/DGScu54Ywbe1mRsMPUWB+2LBpmcZJcoxfbprIVzhTUm45bbxn1VVb4P7oUyRwksjxD7518PKWDPRxZXufFwiAexf25cAQTAeVLvmllSOtgJbtimO1KHG0IU/NankQIsH20U=
    # TF_VAR_firebase_user
    - secure: dHyVvTBz4vcOn4DSFpu1U/aVnsPTrztG4/dmV22ZxAqbgt8MTRijAuIYi+S4HAboSgUKrEPDUa5eT8nHU8bMQWdNqVcbzAXi5yxARf0zWQdffREOwQYuZLBW4NP1UsXISWIXWywvn8cTDkim1WWecZ17E0oqt6s5V95+WJ/Tg+6e7+rWTp3rt3MfY3BbjyatVPy973Vr7PNLIP1HvWbpoo849+iIjqf8lXD6XITT0/y5YtFVVLXdCNAXEXKQ8Du+Si1YNiQ5aJiZ0G5fEaIXmpevorMVKjkxvL2lyqFa1wjBwh3NtqDJLA5M8hU4zQO0rTG3i+Obdtie+o8Rlci5yr4DBlz/Ix3acV1JZSGDUGQEze9hGlAsAdgh94qns9GUdx/vhKgzGv+KubB49Hnf5kWRLRc076+vVhfJIYdBBqZJTsHALsSTROSkh/Wv9UeLuK6fgQ53VrDfob5alivpA63vDGGiG25E5kxuxQby5PFT47AkdYm0LzdzSgX2M9n9WfL1MRmvH57K9ZTn9iA+o+VPl1MorNxdbo5WB5pmc4yjuPEvJrz4WrIuXIFq5QvDEVuAtoOMFlMzzEC0HyzoqgVHEFZUw3jjxtg1xrZP85KjiqV3zBjU7KOEwJhJim3vkk0korRylhpbG3Vavj/gBU3Wwiq991QBunqVJ9R9cSI=
    # TF_VAR_firebase_pw
    - secure: IaAnfK0n5WvqRdFdqfeuE0YoHrM1K0K4Ti7dziz4KraQ6N/LSZ6Z0vlHxLcme5YIHpfw9r1qPpGquiaauDnUApFu2jlr2+4pP/5cL1hwM7pZUFf8xgpUi6A9tNII4CIIGGeSimdExJBopi2f5Q8HSl2pKnBQu9ZJLQQ0H3am9JEaKERzQASq7AaUxIYYCMv2CkCINQp1/0PEB2bhO3YM3623sZA9u55LLK+fVVKWOCNkCIQtg2alueYAIRD38pUWVxZ5hMSxrzX5m47ssoTxVaa8kpCCAHps/NE4Ku3eshNYhthQfZIfhjcWfugXqcJC5PrCBbdD5rJa6xsgtLfLvsUDBQeQIgWfvl0vD9jxo/gB8HgaxMe7Kl1maLFVYwab09rKgY5Idynd0V0SUrMaXsS/KAi4ForYT952FmIb93BuStwjkDvmbFoh+X+x3Y3jfhm3ffpwhRnQ2NbRWUd0hYLxJq2qidREbgXmLBsfDbFUH9HTWJk9+FMyx3ux0Y/UKeSkdcV+WZBeC9P1bVfewpYDr7D0O3LUmcJ9Nx0h3Iuq95gXEFwEIOByrh3X8d8M8o1h7tQoYRtfBucakj32zc/6HQAIQuN+MB1oDWuxgchCp/Lr86NRmYhw+lOfP+BdAKE+w32bDt2rA/bvQcOqm+9VVMOKUNofH7/+1/cVR8s=
